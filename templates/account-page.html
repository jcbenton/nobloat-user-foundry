<div class="nbuf-account-wrapper">

    {messages}

    <!-- Tab Navigation -->
    <div class="nbuf-account-tabs">
        <button type="button" class="nbuf-tab-button nbuf-tab-active" data-tab="account">Account</button>
        {photos_tab_button}
        <button type="button" class="nbuf-tab-button" data-tab="password">Password</button>
        {email_tab_button}
        {security_tab_button}
        {history_tab_button}
        {policies_tab_button}
        <a href="{logout_url}" class="nbuf-tab-logout">Logout</a>
    </div>

    <!-- Account Tab -->
    <div class="nbuf-tab-content nbuf-tab-active" data-tab="account">
        <div class="nbuf-account-section">
            <!-- Read-only Account Info -->
            <div class="nbuf-account-info">
                <div class="nbuf-info-grid">
                    <div class="nbuf-info-label">Member Since:</div>
                    <div class="nbuf-info-value">{registered_date}</div>

                    <div class="nbuf-info-label">Status:</div>
                    <div class="nbuf-info-value">{status_badges}</div>

                    {expiration_info}

                    <div class="nbuf-info-label">Username:</div>
                    <div class="nbuf-info-value">{username}</div>

                    <div class="nbuf-info-label">Email:</div>
                    <div class="nbuf-info-value">{email}</div>
                </div>
            </div>

            <!-- Editable Profile Fields + Visibility -->
            <form method="post" action="{action_url}" class="nbuf-account-form">
                {nonce_field}
                <input type="hidden" name="nbuf_account_action" value="update_profile">
                <input type="hidden" name="nbuf_active_tab" value="account">

                {profile_fields}

                {visibility_section_inline}

                <button type="submit" class="nbuf-button nbuf-button-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Photos Tab (conditionally displayed) -->
    {photos_tab_content}

    <!-- Change Password Tab -->
    <div class="nbuf-tab-content" data-tab="password">
        <div class="nbuf-account-section">
            <form method="post" action="{action_url}" class="nbuf-account-form">
                {nonce_field_password}
                <input type="hidden" name="nbuf_account_action" value="change_password">
                <input type="hidden" name="nbuf_active_tab" value="password">

                <div class="nbuf-form-group">
                    <label for="current_password" class="nbuf-form-label">Current Password</label>
                    <input type="password" id="current_password" name="current_password" class="nbuf-form-input" required>
                </div>

                <div class="nbuf-form-group">
                    <label for="new_password" class="nbuf-form-label">New Password</label>
                    <input type="password" id="new_password" name="new_password" class="nbuf-form-input" required>
                    <small class="nbuf-form-help">{password_requirements}</small>
                </div>

                <div class="nbuf-form-group">
                    <label for="confirm_password" class="nbuf-form-label">Confirm New Password</label>
                    <input type="password" id="confirm_password" name="confirm_password" class="nbuf-form-input" required>
                </div>

                <button type="submit" class="nbuf-button nbuf-button-primary">Change Password</button>
            </form>
        </div>
    </div>

    <!-- Email Tab (conditionally displayed if email changes are enabled) -->
    {email_tab_content}

    <!-- Security Tab (conditionally displayed if 2FA is available) -->
    {security_tab_content}

    <!-- History Tab (conditionally displayed if user access enabled) -->
    {history_tab_content}

    <!-- Policies Tab (conditionally displayed if enabled in settings) -->
    {policies_tab_content}

</div>
