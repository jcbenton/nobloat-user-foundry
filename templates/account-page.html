<div class="nbuf-account-wrapper">

    {messages}

    <!-- Tab Navigation -->
    <div class="nbuf-account-tabs">
        <button type="button" class="nbuf-tab-button nbuf-tab-active" data-tab="account">Account</button>
        {photos_tab_button}
        {email_tab_button}
        {security_tab_button}
        {history_tab_button}
        {policies_tab_button}
        {custom_tabs_buttons}
    </div>

    <!-- Account Tab -->
    <div class="nbuf-tab-content nbuf-tab-active" data-tab="account">
        <div class="nbuf-account-section">
            <h3 style="margin: 0 0 12px 0; font-size: 20px; font-weight: 600; color: #1a202c;">Account Information</h3>
            <p class="nbuf-method-description" style="margin: 0 0 25px 0; font-size: 15px; line-height: 1.6; color: #4a5568;">View your account details and update your profile information.</p>

            <!-- Read-only Account Info -->
            <div class="nbuf-account-info" style="background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; padding: 20px; margin-bottom: 30px;">
                <div class="nbuf-info-grid">
                    <div class="nbuf-info-label">Member Since:</div>
                    <div class="nbuf-info-value">{registered_date}</div>

                    <div class="nbuf-info-label">Status:</div>
                    <div class="nbuf-info-value">{status_badges}</div>

                    {expiration_info}

                    <div class="nbuf-info-label">Username:</div>
                    <div class="nbuf-info-value">{username}</div>

                    <div class="nbuf-info-label">Email:</div>
                    <div class="nbuf-info-value">{email}</div>
                </div>
            </div>

            <!-- Editable Profile Fields + Visibility -->
            <h4 style="margin: 0 0 20px 0; font-size: 16px; font-weight: 600; color: #1a202c;">Edit Profile</h4>
            <form method="post" action="{action_url}" class="nbuf-account-form">
                {nonce_field}
                <input type="hidden" name="nbuf_account_action" value="update_profile">
                <input type="hidden" name="nbuf_active_tab" value="account">

                {profile_fields}

                {visibility_section_inline}

                <button type="submit" class="nbuf-button nbuf-button-primary" style="padding: 12px 24px; font-size: 15px; margin-top: 10px;">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Photos Tab (conditionally displayed) -->
    {photos_tab_content}

    <!-- Email Tab (conditionally displayed if email changes are enabled) -->
    {email_tab_content}

    <!-- Security Tab (conditionally displayed if 2FA is available) -->
    {security_tab_content}

    <!-- History Tab (conditionally displayed if user access enabled) -->
    {history_tab_content}

    <!-- Policies Tab (conditionally displayed if enabled in settings) -->
    {policies_tab_content}

    <!-- Custom Tabs (user-defined tabs with shortcode content) -->
    {custom_tabs_content}

</div>
